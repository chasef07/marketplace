{% extends "base.html" %}

{% block title %}Create Listing{% endblock %}

{% block content %}
<h2>üìù Create New Furniture Listing</h2>

<form method="POST" enctype="multipart/form-data">
    {{ form.hidden_tag() }}
    
    <div class="form-group">
        {{ form.name.label(class="form-label") }}
        {{ form.name(class="form-control", placeholder="e.g. Vintage Leather Couch") }}
        {% for error in form.name.errors %}
            <div class="error">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.furniture_type.label(class="form-label") }}
        {{ form.furniture_type(class="form-control") }}
        {% for error in form.furniture_type.errors %}
            <div class="error">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="form-row">
        <div class="form-group half-width">
            {{ form.starting_price.label(class="form-label") }}
            {{ form.starting_price(class="form-control", placeholder="500.00", id="starting_price") }}
            {% for error in form.starting_price.errors %}
                <div class="error">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group half-width">
            {{ form.min_price.label(class="form-label") }}
            {{ form.min_price(class="form-control", placeholder="300.00", id="min_price") }}
            {% for error in form.min_price.errors %}
                <div class="error">{{ error }}</div>
            {% endfor %}
        </div>
    </div>

    <div class="form-group">
        {{ form.condition.label(class="form-label") }}
        {{ form.condition(class="form-control") }}
        {% for error in form.condition.errors %}
            <div class="error">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.description.label(class="form-label") }}
        {{ form.description(class="form-control", rows="4", placeholder="Describe your furniture item...") }}
        {% for error in form.description.errors %}
            <div class="error">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.image.label(class="form-label") }}
        {{ form.image(class="form-control", accept="image/*") }}
        {% for error in form.image.errors %}
            <div class="error">{{ error }}</div>
        {% endfor %}
        <small class="form-text">Optional. JPG, PNG only, max 5MB</small>
    </div>

    <div class="form-group">
        {{ form.submit(class="btn btn-success") }}
        <a href="{{ url_for('main.homepage') }}" class="btn">Cancel</a>
    </div>
</form>

<style>
.form-row {
    display: flex;
    gap: 15px;
}

.half-width {
    flex: 1;
}

.form-label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.form-control {
    width: 100%;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-sizing: border-box;
}

.form-text {
    color: #666;
    font-size: 0.85em;
}

.error {
    color: #dc3545;
    font-size: 0.85em;
    margin-top: 5px;
}
</style>

<script>
// Auto-calculate minimum price as 60% of starting price
document.getElementById('starting_price').addEventListener('input', function() {
    const price = parseFloat(this.value);
    const minPriceField = document.getElementById('min_price');
    if (price && !minPriceField.value) {
        minPriceField.value = (price * 0.6).toFixed(2);
    }
});
</script>
{% endblock %}